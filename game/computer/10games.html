<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡∏ñ‡∏°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Kanit', sans-serif; }
        
        .game-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .coin-animation {
            animation: coinFloat 2s ease-out forwards;
            pointer-events: none;
            z-index: 1000;
        }
        
        @keyframes coinFloat {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-100px) scale(1.5); opacity: 0; }
        }
        
        .star-rating {
            display: inline-flex;
            gap: 2px;
        }
        
        .star {
            color: #ffd700;
            font-size: 1.2em;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.35s;
            transform-origin: 50% 50%;
        }
        
        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            z-index: 2000;
            animation: achievementShow 3s ease-out forwards;
        }
        
        @keyframes achievementShow {
            0% { transform: translate(-50%, -50%) scale(0); }
            10% { transform: translate(-50%, -50%) scale(1.1); }
            20% { transform: translate(-50%, -50%) scale(1); }
            90% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
        }
        
        .combo-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            transform: scale(0);
            animation: comboShow 0.5s ease-out forwards;
        }
        
        @keyframes comboShow {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .difficulty-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .easy { background: #4CAF50; color: white; }
        .medium { background: #FF9800; color: white; }
        .hard { background: #F44336; color: white; }
        .expert { background: #9C27B0; color: white; }
        
        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ffd700;
            border-radius: 50%;
            pointer-events: none;
            animation: particleFloat 1s ease-out forwards;
        }
        
        @keyframes particleFloat {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-80px) scale(0); opacity: 0; }
        }
        
        .level-card {
            transition: all 0.3s ease;
            transform: scale(1);
        }
        
        .level-card:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        
        .completed {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }
        
        .current {
            background: linear-gradient(135deg, #FF9800, #F57C00);
            animation: pulse 2s infinite;
        }
        
        .locked {
            background: #9E9E9E;
            opacity: 0.6;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 152, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0); }
        }
        
        .draggable {
            cursor: grab;
            transition: transform 0.2s;
        }
        
        .draggable:active {
            cursor: grabbing;
            transform: scale(1.1);
        }
        
        .drop-zone {
            border: 3px dashed #ccc;
            transition: all 0.3s;
        }
        
        .drop-zone.drag-over {
            border-color: #4CAF50;
            background-color: rgba(76, 175, 80, 0.1);
        }
        
        .typing-cursor {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .maze-cell {
            width: 30px;
            height: 30px;
            border: 1px solid #ddd;
        }
        
        .maze-wall { background: #333; }
        .maze-path { background: #fff; }
        .maze-player { background: #4CAF50; border-radius: 50%; }
        .maze-goal { background: #FF9800; border-radius: 50%; }
        
        .pattern-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .pattern-button.active {
            transform: scale(1.2);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
        }
        
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .sound-toggle:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á -->
        <div class="sound-toggle" onclick="toggleSound()" title="‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á">
            <span id="soundIcon">üîä</span>
        </div>
        
        <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
        <div id="mainMenu" class="min-h-screen flex items-center justify-center p-4">
            <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-4xl w-full">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-purple-600 mb-4">üéÆ ‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</h1>
                    <p class="text-xl text-gray-600">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡∏ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
                    <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="p-4 bg-yellow-100 rounded-lg text-center">
                            <p class="text-lg">üèÜ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</p>
                            <p class="text-2xl font-bold text-purple-600"><span id="totalHighScore">0</span></p>
                        </div>
                        <div class="p-4 bg-green-100 rounded-lg text-center">
                            <p class="text-lg">ü™ô ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏≠‡∏á</p>
                            <p class="text-2xl font-bold text-yellow-600"><span id="totalCoins">0</span></p>
                        </div>
                        <div class="p-4 bg-blue-100 rounded-lg text-center">
                            <p class="text-lg">‚≠ê ‡∏î‡πà‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô</p>
                            <p class="text-2xl font-bold text-blue-600"><span id="levelsCompleted">0</span>/10</p>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
                    <div class="level-card bg-gradient-to-br from-blue-400 to-blue-600 text-white p-4 rounded-xl cursor-pointer current relative" onclick="startLevel(1)">
                        <div class="difficulty-badge easy">‡∏á‡πà‡∏≤‡∏¢</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üñ±Ô∏è</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 1</div>
                            <div class="text-sm">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score1">0</span></div>
                            <div class="star-rating mt-1" id="stars1">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(2)">
                        <div class="difficulty-badge easy">‡∏á‡πà‡∏≤‡∏¢</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üéØ</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 2</div>
                            <div class="text-sm">‡πÄ‡∏•‡πá‡∏á‡πÄ‡∏õ‡πâ‡∏≤</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score2">0</span></div>
                            <div class="star-rating mt-1" id="stars2">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-yellow-400 to-yellow-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(3)">
                        <div class="difficulty-badge medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üî§</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 3</div>
                            <div class="text-sm">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏î‡∏µ‡∏î</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score3">0</span></div>
                            <div class="star-rating mt-1" id="stars3">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-red-400 to-red-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(4)">
                        <div class="difficulty-badge medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üß©</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 4</div>
                            <div class="text-sm">‡∏•‡∏≤‡∏Å‡∏ß‡∏≤‡∏á</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score4">0</span></div>
                            <div class="star-rating mt-1" id="stars4">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-purple-400 to-purple-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(5)">
                        <div class="difficulty-badge medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üé®</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 5</div>
                            <div class="text-sm">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏™‡∏µ</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score5">0</span></div>
                            <div class="star-rating mt-1" id="stars5">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-indigo-400 to-indigo-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(6)">
                        <div class="difficulty-badge hard">‡∏¢‡∏≤‡∏Å</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üß†</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 6</div>
                            <div class="text-sm">‡∏à‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score6">0</span></div>
                            <div class="star-rating mt-1" id="stars6">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-pink-400 to-pink-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(7)">
                        <div class="difficulty-badge hard">‡∏¢‡∏≤‡∏Å</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">‚å®Ô∏è</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 7</div>
                            <div class="text-sm">‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score7">0</span></div>
                            <div class="star-rating mt-1" id="stars7">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-teal-400 to-teal-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(8)">
                        <div class="difficulty-badge hard">‡∏¢‡∏≤‡∏Å</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üóÇÔ∏è</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 8</div>
                            <div class="text-sm">‡∏à‡∏±‡∏î‡πÑ‡∏ü‡∏•‡πå</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score8">0</span></div>
                            <div class="star-rating mt-1" id="stars8">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-orange-400 to-orange-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(9)">
                        <div class="difficulty-badge expert">‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üöÄ</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 9</div>
                            <div class="text-sm">‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score9">0</span></div>
                            <div class="star-rating mt-1" id="stars9">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="level-card bg-gradient-to-br from-gray-400 to-gray-600 text-white p-4 rounded-xl cursor-pointer locked relative" onclick="startLevel(10)">
                        <div class="difficulty-badge expert">‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</div>
                        <div class="text-center">
                            <div class="text-3xl mb-2">üëë</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 10</div>
                            <div class="text-sm">‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô</div>
                            <div class="text-xs mt-1">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="score10">0</span></div>
                            <div class="star-rating mt-1" id="stars10">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center space-x-4">
                    <button onclick="showLeaderboard()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
                        üèÜ ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                    </button>
                    <button onclick="resetAllScores()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
                        üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    </button>
                </div>
                
                <!-- Footer -->
                <div class="mt-8 pt-6 border-t border-gray-200 text-center text-gray-600">
                    <p class="text-sm">¬© developed by Tle Narongphisit | CTTC19 @ CPD</p>
                </div>
            </div>
        </div>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤ Leaderboard -->
        <div id="leaderboardScreen" class="hidden min-h-screen flex items-center justify-center p-4">
            <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-4xl w-full">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-yellow-600 mb-4">üèÜ ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h1>
                    <p class="text-xl text-gray-600">‡∏ú‡∏π‡πâ‡∏ó‡∏≥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 10 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å</p>
                </div>
                
                <div class="mb-6">
                    <div class="text-center mb-4">
                        <input type="text" id="playerNameInput" placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..." 
                               class="px-4 py-2 border-2 border-purple-300 rounded-lg text-center text-lg w-64">
                        <button onclick="savePlayerName()" class="ml-2 bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg">
                            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠
                        </button>
                    </div>
                    <div class="text-center text-sm text-gray-500">
                        ‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span id="currentPlayerName" class="font-semibold">‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
                    <div class="bg-gradient-to-br from-yellow-100 to-yellow-200 p-6 rounded-xl">
                        <h3 class="text-xl font-bold text-yellow-800 mb-4 text-center">üèÜ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</h3>
                        <div id="totalScoreLeaderboard" class="space-y-2">
                            <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>
                    
                    <!-- ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î -->
                    <div class="bg-gradient-to-br from-orange-100 to-orange-200 p-6 rounded-xl">
                        <h3 class="text-xl font-bold text-orange-800 mb-4 text-center">ü™ô ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î</h3>
                        <div id="coinsLeaderboard" class="space-y-2">
                            <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>
                </div>
                
                <!-- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πà‡∏≤‡∏ô -->
                <div class="mt-8">
                    <h3 class="text-xl font-bold text-purple-800 mb-4 text-center">üéÆ ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πà‡∏≤‡∏ô</h3>
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg text-center" id="levelStats1">
                            <div class="text-2xl mb-2">üñ±Ô∏è</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 1</div>
                            <div class="text-sm text-blue-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest1">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer1">-</span></div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg text-center" id="levelStats2">
                            <div class="text-2xl mb-2">üéØ</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 2</div>
                            <div class="text-sm text-green-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest2">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer2">-</span></div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg text-center" id="levelStats3">
                            <div class="text-2xl mb-2">üî§</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 3</div>
                            <div class="text-sm text-yellow-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest3">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer3">-</span></div>
                        </div>
                        <div class="bg-red-50 p-4 rounded-lg text-center" id="levelStats4">
                            <div class="text-2xl mb-2">üß©</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 4</div>
                            <div class="text-sm text-red-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest4">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer4">-</span></div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg text-center" id="levelStats5">
                            <div class="text-2xl mb-2">üé®</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 5</div>
                            <div class="text-sm text-purple-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest5">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer5">-</span></div>
                        </div>
                        <div class="bg-indigo-50 p-4 rounded-lg text-center" id="levelStats6">
                            <div class="text-2xl mb-2">üß†</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 6</div>
                            <div class="text-sm text-indigo-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest6">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer6">-</span></div>
                        </div>
                        <div class="bg-pink-50 p-4 rounded-lg text-center" id="levelStats7">
                            <div class="text-2xl mb-2">‚å®Ô∏è</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 7</div>
                            <div class="text-sm text-pink-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest7">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer7">-</span></div>
                        </div>
                        <div class="bg-teal-50 p-4 rounded-lg text-center" id="levelStats8">
                            <div class="text-2xl mb-2">üóÇÔ∏è</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 8</div>
                            <div class="text-sm text-teal-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest8">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer8">-</span></div>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg text-center" id="levelStats9">
                            <div class="text-2xl mb-2">üöÄ</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 9</div>
                            <div class="text-sm text-orange-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest9">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer9">-</span></div>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg text-center" id="levelStats10">
                            <div class="text-2xl mb-2">üëë</div>
                            <div class="font-semibold">‡∏î‡πà‡∏≤‡∏ô 10</div>
                            <div class="text-sm text-gray-600">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="levelBest10">0</span></div>
                            <div class="text-xs text-gray-500">‡πÇ‡∏î‡∏¢: <span id="levelBestPlayer10">-</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-8 space-x-4">
                    <button onclick="backToMenuFromLeaderboard()" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
                        ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    </button>
                    <button onclick="resetLeaderboard()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
                        üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á Leaderboard
                    </button>
                </div>
            </div>
        </div>

        <!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏° -->
        <div id="gameScreen" class="hidden min-h-screen p-4">
            <div class="max-w-4xl mx-auto">
                <!-- Header -->
                <div class="bg-white rounded-xl shadow-lg p-4 mb-4 flex justify-between items-center relative">
                    <button onclick="backToMenu()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ‚Üê ‡∏Å‡∏•‡∏±‡∏ö
                    </button>
                    <div class="text-center">
                        <h2 id="levelTitle" class="text-2xl font-bold text-purple-600"></h2>
                        <p id="levelDescription" class="text-gray-600"></p>
                    </div>
                    <div class="text-right">
                        <div class="flex items-center gap-4">
                            <div class="text-center">
                                <div class="text-lg font-semibold">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
                                <div class="text-2xl font-bold text-purple-600"><span id="currentScore">0</span></div>
                            </div>
                            <div class="text-center">
                                <div class="text-lg font-semibold">‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç</div>
                                <div class="text-2xl font-bold text-yellow-600">ü™ô <span id="currentCoins">0</span></div>
                            </div>
                            <div class="text-center">
                                <div class="text-lg font-semibold">‡πÄ‡∏ß‡∏•‡∏≤</div>
                                <div class="relative inline-block">
                                    <svg class="progress-ring w-16 h-16" width="64" height="64">
                                        <circle class="progress-ring-circle" stroke="#e5e7eb" stroke-width="4" fill="transparent" r="28" cx="32" cy="32"/>
                                        <circle id="progressCircle" class="progress-ring-circle" stroke="#3b82f6" stroke-width="4" fill="transparent" r="28" cx="32" cy="32" stroke-dasharray="175.929" stroke-dashoffset="0"/>
                                    </svg>
                                    <div class="absolute inset-0 flex items-center justify-center">
                                        <span id="timeLeft" class="text-lg font-bold">60</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Game Area -->
                <div id="gameArea" class="bg-white rounded-xl shadow-lg p-8 min-h-96">
                    <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏Å‡∏°‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentLevel = 1;
        let currentScore = 0;
        let currentCoins = 0;
        let timeLeft = 60;
        let gameTimer = null;
        let gameData = {};
        let combo = 0;
        let lastActionTime = 0;
        let achievements = [];
        let soundEnabled = true;
        let playerName = '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠';

        // ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á
        const sounds = {
            click: () => playBeep(800, 100),
            success: () => playBeep(1000, 200),
            error: () => playBeep(300, 300),
            coin: () => playBeep(1200, 150),
            achievement: () => {
                playBeep(800, 100);
                setTimeout(() => playBeep(1000, 100), 100);
                setTimeout(() => playBeep(1200, 200), 200);
            },
            levelComplete: () => {
                playBeep(600, 150);
                setTimeout(() => playBeep(800, 150), 150);
                setTimeout(() => playBeep(1000, 300), 300);
            },
            combo: () => {
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => playBeep(1000 + (i * 200), 100), i * 50);
                }
            }
        };

        function playBeep(frequency, duration) {
            if (!soundEnabled) return;
            
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration / 1000);
            } catch (e) {
                // ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÑ‡∏î‡πâ
            }
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('soundIcon').textContent = soundEnabled ? 'üîä' : 'üîá';
            localStorage.setItem('soundEnabled', soundEnabled);
            
            if (soundEnabled) {
                sounds.click();
            }
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏≤‡∏Å localStorage
        function loadScores() {
            for (let i = 1; i <= 10; i++) {
                const score = localStorage.getItem(`level${i}Score`) || 0;
                document.getElementById(`score${i}`).textContent = score;
                updateStarRating(i, score);
            }
            updateTotalHighScore();
            updateTotalCoins();
            updateLevelsCompleted();
            updateLevelStates();
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á
            const savedSoundSetting = localStorage.getItem('soundEnabled');
            if (savedSoundSetting !== null) {
                soundEnabled = savedSoundSetting === 'true';
                document.getElementById('soundIcon').textContent = soundEnabled ? 'üîä' : 'üîá';
            }
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
            playerName = localStorage.getItem('playerName') || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠';
        }

        // ‡∏£‡∏∞‡∏ö‡∏ö Leaderboard
        function showLeaderboard() {
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('leaderboardScreen').classList.remove('hidden');
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            document.getElementById('currentPlayerName').textContent = playerName;
            document.getElementById('playerNameInput').value = playerName === '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠' ? '' : playerName;
            
            updateLeaderboards();
            sounds.click();
        }

        function backToMenuFromLeaderboard() {
            document.getElementById('leaderboardScreen').classList.add('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
            sounds.click();
        }

        function savePlayerName() {
            const nameInput = document.getElementById('playerNameInput');
            const newName = nameInput.value.trim();
            const currentName = playerName;
            
            if (!newName) {
                sounds.error();
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠');
                return;
            }
            
            if (newName.length > 20) {
                sounds.error();
                alert('‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 20 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
                return;
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (currentName !== '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠' && newName !== currentName) {
                const confirmMessage = `‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï!\n\n‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏°: "${currentName}"\n‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà: "${newName}"\n\nüîÑ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\nüìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Leaderboard ‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà\n\n‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`;
                
                if (!confirm(confirmMessage)) {
                    sounds.click();
                    return;
                }
                
                // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                resetPlayerScores();
                sounds.success();
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                showAchievement('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà!', `‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${newName}`);
                
                // ‡πÅ‡∏™‡∏î‡∏á alert ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
                setTimeout(() => {
                    alert(`üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß!\n\n‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô: ${newName}\n‚úÖ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï\nüéØ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏´‡∏°‡πà`);
                }, 1000);
            }
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà
            playerName = newName;
            localStorage.setItem('playerName', playerName);
            document.getElementById('currentPlayerName').textContent = playerName;
            
            if (currentName === '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠' || newName === currentName) {
                sounds.success();
                showAchievement('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß!', `‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ${playerName}`);
            }
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó leaderboard ‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            updateLeaderboards();
            loadScores();
        }
        
        function resetPlayerScores() {
            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πà‡∏≤‡∏ô
            for (let i = 1; i <= 10; i++) {
                localStorage.removeItem(`level${i}Score`);
            }
            
            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            localStorage.removeItem('totalCoins');
            
            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            loadScores();
        }

        function updateLeaderboards() {
            updateTotalScoreLeaderboard();
            updateCoinsLeaderboard();
            updateLevelBestScores();
        }

        function updateTotalScoreLeaderboard() {
            const leaderboard = getLeaderboardData('totalScore');
            const container = document.getElementById('totalScoreLeaderboard');
            
            if (leaderboard.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
                return;
            }
            
            container.innerHTML = leaderboard.map((entry, index) => {
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
                const bgColor = index === 0 ? 'bg-yellow-50 border-yellow-200' : 
                               index === 1 ? 'bg-gray-50 border-gray-200' : 
                               index === 2 ? 'bg-orange-50 border-orange-200' : 'bg-white border-gray-100';
                
                return `
                    <div class="flex justify-between items-center p-3 rounded-lg border-2 ${bgColor}">
                        <div class="flex items-center gap-2">
                            <span class="text-lg font-bold">${medal}</span>
                            <span class="font-semibold">${entry.name}</span>
                        </div>
                        <div class="text-lg font-bold text-yellow-600">${entry.score}</div>
                    </div>
                `;
            }).join('');
        }

        function updateCoinsLeaderboard() {
            const leaderboard = getLeaderboardData('coins');
            const container = document.getElementById('coinsLeaderboard');
            
            if (leaderboard.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-500 py-4">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
                return;
            }
            
            container.innerHTML = leaderboard.map((entry, index) => {
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
                const bgColor = index === 0 ? 'bg-yellow-50 border-yellow-200' : 
                               index === 1 ? 'bg-gray-50 border-gray-200' : 
                               index === 2 ? 'bg-orange-50 border-orange-200' : 'bg-white border-gray-100';
                
                return `
                    <div class="flex justify-between items-center p-3 rounded-lg border-2 ${bgColor}">
                        <div class="flex items-center gap-2">
                            <span class="text-lg font-bold">${medal}</span>
                            <span class="font-semibold">${entry.name}</span>
                        </div>
                        <div class="text-lg font-bold text-orange-600">ü™ô ${entry.score}</div>
                    </div>
                `;
            }).join('');
        }

        function updateLevelBestScores() {
            for (let level = 1; level <= 10; level++) {
                const bestScore = getBestScoreForLevel(level);
                document.getElementById(`levelBest${level}`).textContent = bestScore.score;
                document.getElementById(`levelBestPlayer${level}`).textContent = bestScore.name;
            }
        }

        function getLeaderboardData(type) {
            const entries = [];
            
            // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage
            const savedEntries = JSON.parse(localStorage.getItem('leaderboardEntries') || '[]');
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            let currentTotalScore = 0;
            for (let i = 1; i <= 10; i++) {
                currentTotalScore += parseInt(localStorage.getItem(`level${i}Score`) || 0);
            }
            const currentCoins = parseInt(localStorage.getItem('totalCoins') || 0);
            
            if (currentTotalScore > 0 || currentCoins > 0) {
                const currentEntry = {
                    name: playerName,
                    totalScore: currentTotalScore,
                    coins: currentCoins,
                    timestamp: Date.now()
                };
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const existingIndex = savedEntries.findIndex(entry => entry.name === playerName);
                if (existingIndex >= 0) {
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°
                    savedEntries[existingIndex] = currentEntry;
                } else {
                    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
                    savedEntries.push(currentEntry);
                }
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏•‡∏±‡∏ö localStorage
                localStorage.setItem('leaderboardEntries', JSON.stringify(savedEntries));
            }
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô
            if (type === 'totalScore') {
                return savedEntries
                    .sort((a, b) => b.totalScore - a.totalScore)
                    .slice(0, 10)
                    .map(entry => ({ name: entry.name, score: entry.totalScore }));
            } else if (type === 'coins') {
                return savedEntries
                    .sort((a, b) => b.coins - a.coins)
                    .slice(0, 10)
                    .map(entry => ({ name: entry.name, score: entry.coins }));
            }
            
            return [];
        }

        function getBestScoreForLevel(level) {
            const levelScores = JSON.parse(localStorage.getItem(`level${level}Scores`) || '[]');
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
            const currentScore = parseInt(localStorage.getItem(`level${level}Score`) || 0);
            if (currentScore > 0) {
                const currentEntry = {
                    name: playerName,
                    score: currentScore,
                    timestamp: Date.now()
                };
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const existingIndex = levelScores.findIndex(entry => entry.name === playerName);
                if (existingIndex >= 0) {
                    // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤
                    if (currentScore > levelScores[existingIndex].score) {
                        levelScores[existingIndex] = currentEntry;
                    }
                } else {
                    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
                    levelScores.push(currentEntry);
                }
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏•‡∏±‡∏ö localStorage
                localStorage.setItem(`level${level}Scores`, JSON.stringify(levelScores));
            }
            
            // ‡∏´‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
            if (levelScores.length === 0) {
                return { name: '-', score: 0 };
            }
            
            const best = levelScores.reduce((max, current) => 
                current.score > max.score ? current : max
            );
            
            return { name: best.name, score: best.score };
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏î‡∏≤‡∏ß
        function updateStarRating(level, score) {
            const starsElement = document.getElementById(`stars${level}`);
            if (!starsElement) return;
            
            let stars = 0;
            if (score >= 50) stars = 1;
            if (score >= 100) stars = 2;
            if (score >= 200) stars = 3;
            
            const starSpans = starsElement.querySelectorAll('.star');
            starSpans.forEach((star, index) => {
                star.textContent = index < stars ? '‚òÖ' : '‚òÜ';
            });
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
        function addCoins(amount, element = null) {
            currentCoins += amount;
            document.getElementById('currentCoins').textContent = currentCoins;
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏£‡∏ß‡∏°
            const totalCoins = parseInt(localStorage.getItem('totalCoins') || 0) + amount;
            localStorage.setItem('totalCoins', totalCoins);
            
            // ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
            if (element) {
                createCoinEffect(element, amount);
            }
            
            // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
            sounds.coin();
        }

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç
        function createCoinEffect(element, amount) {
            const rect = element.getBoundingClientRect();
            const coin = document.createElement('div');
            coin.className = 'coin-animation fixed text-2xl font-bold text-yellow-500';
            coin.textContent = `+${amount}ü™ô`;
            coin.style.left = rect.left + rect.width/2 + 'px';
            coin.style.top = rect.top + 'px';
            document.body.appendChild(coin);
            
            setTimeout(() => coin.remove(), 2000);
        }

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏≠‡∏ô‡∏∏‡∏†‡∏≤‡∏Ñ
        function createParticles(element) {
            const rect = element.getBoundingClientRect();
            for (let i = 0; i < 5; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle fixed';
                particle.style.left = (rect.left + rect.width/2 + (Math.random() - 0.5) * 50) + 'px';
                particle.style.top = (rect.top + rect.height/2) + 'px';
                document.body.appendChild(particle);
                
                setTimeout(() => particle.remove(), 1000);
            }
        }

        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö
        function updateCombo() {
            const now = Date.now();
            if (now - lastActionTime < 2000) {
                combo++;
                if (combo >= 5) {
                    showComboIndicator();
                    addCoins(combo, document.getElementById('currentScore'));
                    sounds.combo();
                }
            } else {
                combo = 1;
            }
            lastActionTime = now;
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏Ñ‡∏≠‡∏°‡πÇ‡∏ö
        function showComboIndicator() {
            const existing = document.querySelector('.combo-indicator');
            if (existing) existing.remove();
            
            const indicator = document.createElement('div');
            indicator.className = 'combo-indicator';
            indicator.textContent = `COMBO x${combo}!`;
            document.getElementById('gameArea').appendChild(indicator);
            
            setTimeout(() => indicator.remove(), 2000);
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
        function showAchievement(title, description) {
            const popup = document.createElement('div');
            popup.className = 'achievement-popup';
            popup.innerHTML = `
                <div class="text-center">
                    <div class="text-4xl mb-2">üèÜ</div>
                    <div class="text-xl font-bold text-purple-800">${title}</div>
                    <div class="text-sm text-purple-600">${description}</div>
                </div>
            `;
            document.body.appendChild(popup);
            
            sounds.achievement();
            setTimeout(() => popup.remove(), 3000);
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°
        function updateTotalHighScore() {
            let total = 0;
            for (let i = 1; i <= 10; i++) {
                total += parseInt(localStorage.getItem(`level${i}Score`) || 0);
            }
            document.getElementById('totalHighScore').textContent = total;
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏£‡∏ß‡∏°
        function updateTotalCoins() {
            const total = localStorage.getItem('totalCoins') || 0;
            document.getElementById('totalCoins').textContent = total;
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô
        function updateLevelsCompleted() {
            let completed = 0;
            for (let i = 1; i <= 10; i++) {
                const score = parseInt(localStorage.getItem(`level${i}Score`) || 0);
                if (score > 0) completed++;
            }
            document.getElementById('levelsCompleted').textContent = completed;
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏î‡πà‡∏≤‡∏ô
        function updateLevelStates() {
            const cards = document.querySelectorAll('.level-card');
            let unlockedLevel = 1;
            
            // ‡∏´‡∏≤‡∏î‡πà‡∏≤‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß
            for (let i = 1; i <= 10; i++) {
                const score = parseInt(localStorage.getItem(`level${i}Score`) || 0);
                if (score > 0) {
                    unlockedLevel = Math.min(i + 1, 10);
                }
            }
            
            cards.forEach((card, index) => {
                const level = index + 1;
                card.classList.remove('completed', 'current', 'locked');
                
                if (level < unlockedLevel) {
                    // ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß
                    card.classList.add('completed');
                    card.onclick = () => startLevel(level);
                } else if (level === unlockedLevel) {
                    // ‡∏î‡πà‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ
                    card.classList.add('current');
                    card.onclick = () => startLevel(level);
                } else {
                    // ‡∏î‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¢‡∏π‡πà
                    card.classList.add('locked');
                    card.onclick = () => {
                        sounds.error();
                        alert(`‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô ${level-1} ‡∏Å‡πà‡∏≠‡∏ô!`);
                    };
                }
            });
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
        function startLevel(level) {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏î‡πà‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (level > 1) {
                const prevScore = parseInt(localStorage.getItem(`level${level-1}Score`) || 0);
                if (prevScore === 0) {
                    sounds.error();
                    alert(`‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô ${level-1} ‡∏Å‡πà‡∏≠‡∏ô!`);
                    return;
                }
            }
            
            currentLevel = level;
            currentScore = 0;
            currentCoins = 0;
            timeLeft = 60;
            combo = 0;
            lastActionTime = 0;
            
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('currentScore').textContent = '0';
            document.getElementById('currentCoins').textContent = '0';
            
            sounds.click();
            setupLevel(level);
            startTimer();
        }

        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏î‡πà‡∏≤‡∏ô
        function setupLevel(level) {
            const titles = [
                '', '‡∏î‡πà‡∏≤‡∏ô 1: ‡∏ù‡∏∂‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå', '‡∏î‡πà‡∏≤‡∏ô 2: ‡πÄ‡∏•‡πá‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏°‡πà‡∏ô', '‡∏î‡πà‡∏≤‡∏ô 3: ‡∏ù‡∏∂‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå‡∏î‡∏µ‡∏î',
                '‡∏î‡πà‡∏≤‡∏ô 4: ‡∏•‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á', '‡∏î‡πà‡∏≤‡∏ô 5: ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏™‡∏µ', '‡∏î‡πà‡∏≤‡∏ô 6: ‡∏à‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö', '‡∏î‡πà‡∏≤‡∏ô 7: ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î',
                '‡∏î‡πà‡∏≤‡∏ô 8: ‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÑ‡∏ü‡∏•‡πå', '‡∏î‡πà‡∏≤‡∏ô 9: ‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï', '‡∏î‡πà‡∏≤‡∏ô 10: ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô'
            ];
            
            const descriptions = [
                '', '‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î', '‡πÄ‡∏•‡πá‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß', '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
                '‡∏•‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', '‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏™‡∏µ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô', '‡∏à‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏ï‡∏≤‡∏°', '‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á',
                '‡∏à‡∏±‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', '‡∏ô‡∏≥‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï', '‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏≤'
            ];
            
            document.getElementById('levelTitle').textContent = titles[level];
            document.getElementById('levelDescription').textContent = descriptions[level];
            document.getElementById('currentScore').textContent = '0';
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏°‡∏ï‡∏≤‡∏°‡∏î‡πà‡∏≤‡∏ô
            switch(level) {
                case 1: setupClickGame(); break;
                case 2: setupTargetGame(); break;
                case 3: setupTypingGame(); break;
                case 4: setupDragDropGame(); break;
                case 5: setupColorMatchGame(); break;
                case 6: setupSequenceGame(); break;
                case 7: setupShortcutGame(); break;
                case 8: setupFileOrganizerGame(); break;
                case 9: setupMazeGame(); break;
                case 10: setupFinalGame(); break;
            }
        }

        // ‡∏î‡πà‡∏≤‡∏ô 1: ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå
        function setupClickGame() {
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = `
                <div class="text-center">
                    <div class="text-xl mb-4">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏Ç‡∏∂‡πâ‡∏ô!</div>
                    <div id="clickTarget" class="w-32 h-32 bg-blue-500 hover:bg-blue-600 rounded-full mx-auto flex items-center justify-center text-white text-2xl font-bold cursor-pointer transition-all transform hover:scale-110" onclick="clickHit()">
                        ‡∏Ñ‡∏•‡∏¥‡∏Å!
                    </div>
                    <div class="mt-4 text-lg">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß: <span id="clickCount">0</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                </div>
            `;
            
            gameData.clickCount = 0;
            moveClickTarget();
        }

        function moveClickTarget() {
            const target = document.getElementById('clickTarget');
            if (!target || timeLeft <= 0) return;
            
            const gameArea = document.getElementById('gameArea');
            const maxX = Math.max(200, gameArea.offsetWidth - 150);
            const maxY = Math.max(200, gameArea.offsetHeight - 200);
            
            const x = Math.random() * maxX;
            const y = Math.random() * maxY + 50; // ‡πÄ‡∏ß‡πâ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô
            
            target.style.position = 'absolute';
            target.style.left = x + 'px';
            target.style.top = y + 'px';
        }

        function clickHit() {
            gameData.clickCount++;
            currentScore += 10;
            updateCombo();
            addCoins(1, document.getElementById('clickTarget'));
            createParticles(document.getElementById('clickTarget'));
            sounds.success();
            
            document.getElementById('clickCount').textContent = gameData.clickCount;
            document.getElementById('currentScore').textContent = currentScore;
            moveClickTarget();
            
            // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            if (gameData.clickCount === 10) {
                showAchievement('‡∏ô‡∏±‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å!', '‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏£‡∏ö 10 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        // ‡∏î‡πà‡∏≤‡∏ô 2: ‡πÄ‡∏•‡πá‡∏á‡πÄ‡∏õ‡πâ‡∏≤
        function setupTargetGame() {
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = `
                <div class="relative h-96 bg-gradient-to-b from-blue-200 to-green-200 rounded-lg overflow-hidden">
                    <div id="movingTarget" class="absolute w-16 h-16 bg-red-500 rounded-full cursor-pointer flex items-center justify-center text-white font-bold" onclick="targetHit()">
                        üéØ
                    </div>
                    <div class="absolute top-4 left-4 bg-white p-2 rounded">
                        ‡πÄ‡∏õ‡πâ‡∏≤‡πÇ‡∏î‡∏ô: <span id="targetHits">0</span>
                    </div>
                </div>
            `;
            
            gameData.targetHits = 0;
            gameData.targetSpeed = 2;
            gameData.targetDirection = { x: 1, y: 1 };
            gameData.targetPosition = { x: 100, y: 100 };
            
            moveTarget();
        }

        function moveTarget() {
            const target = document.getElementById('movingTarget');
            if (!target || timeLeft <= 0) return;
            
            const gameArea = target.parentElement;
            const maxX = gameArea.offsetWidth - 64;
            const maxY = gameArea.offsetHeight - 64;
            
            gameData.targetPosition.x += gameData.targetDirection.x * gameData.targetSpeed;
            gameData.targetPosition.y += gameData.targetDirection.y * gameData.targetSpeed;
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï
            if (gameData.targetPosition.x <= 0) {
                gameData.targetPosition.x = 0;
                gameData.targetDirection.x *= -1;
            }
            if (gameData.targetPosition.x >= maxX) {
                gameData.targetPosition.x = maxX;
                gameData.targetDirection.x *= -1;
            }
            if (gameData.targetPosition.y <= 0) {
                gameData.targetPosition.y = 0;
                gameData.targetDirection.y *= -1;
            }
            if (gameData.targetPosition.y >= maxY) {
                gameData.targetPosition.y = maxY;
                gameData.targetDirection.y *= -1;
            }
            
            target.style.left = gameData.targetPosition.x + 'px';
            target.style.top = gameData.targetPosition.y + 'px';
            
            if (currentLevel === 2 && timeLeft > 0) {
                setTimeout(moveTarget, 50);
            }
        }

        function targetHit() {
            gameData.targetHits++;
            currentScore += 20;
            gameData.targetSpeed += 0.5;
            updateCombo();
            addCoins(2, document.getElementById('movingTarget'));
            createParticles(document.getElementById('movingTarget'));
            sounds.success();
            
            document.getElementById('targetHits').textContent = gameData.targetHits;
            document.getElementById('currentScore').textContent = currentScore;
            
            // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            if (gameData.targetHits === 5) {
                showAchievement('‡∏ô‡∏±‡∏Å‡πÄ‡∏•‡πá‡∏á!', '‡πÄ‡∏•‡πá‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡πÇ‡∏î‡∏ô 5 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        // ‡∏î‡πà‡∏≤‡∏ô 3: ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏î‡∏µ‡∏î
        function setupTypingGame() {
            const words = ['‡πÄ‡∏°‡∏≤‡∏™‡πå', '‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î', '‡∏à‡∏≠‡∏†‡∏≤‡∏û', '‡∏•‡∏≥‡πÇ‡∏û‡∏á', '‡πÑ‡∏°‡∏Ñ‡πå', '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå', '‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå', '‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏Ñ‡∏°', '‡∏Æ‡∏≤‡∏£‡πå‡∏î‡∏î‡∏¥‡∏™‡∏Å‡πå', '‡πÅ‡∏£‡∏°'];
            const gameArea = document.getElementById('gameArea');
            
            gameArea.innerHTML = `
                <div class="text-center">
                    <div class="text-xl mb-4">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è:</div>
                    <div id="wordToType" class="text-4xl font-bold text-purple-600 mb-4">${words[0]}</div>
                    <input type="text" id="typingInput" class="text-2xl p-4 border-2 border-purple-300 rounded-lg text-center w-64" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." autocomplete="off">
                    <div class="mt-4 text-lg">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ñ‡∏π‡∏Å: <span id="typingScore">0</span> ‡∏Ñ‡∏≥</div>
                </div>
            `;
            
            gameData.words = words;
            gameData.currentWordIndex = 0;
            gameData.typingScore = 0;
            
            const input = document.getElementById('typingInput');
            input.addEventListener('input', checkTyping);
            input.focus();
        }

        function checkTyping() {
            const input = document.getElementById('typingInput');
            const currentWord = gameData.words[gameData.currentWordIndex];
            
            if (input.value === currentWord) {
                gameData.typingScore++;
                currentScore += 15;
                updateCombo();
                addCoins(2, input);
                createParticles(input);
                sounds.success();
                
                gameData.currentWordIndex = (gameData.currentWordIndex + 1) % gameData.words.length;
                
                document.getElementById('wordToType').textContent = gameData.words[gameData.currentWordIndex];
                document.getElementById('typingScore').textContent = gameData.typingScore;
                document.getElementById('currentScore').textContent = currentScore;
                input.value = '';
                
                // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                if (gameData.typingScore === 10) {
                    showAchievement('‡∏ô‡∏±‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå!', '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ñ‡∏π‡∏Å 10 ‡∏Ñ‡∏≥‡πÅ‡∏•‡πâ‡∏ß');
                }
            }
        }

        // ‡∏î‡πà‡∏≤‡∏ô 4: ‡∏•‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á
        function setupDragDropGame() {
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = `
                <div class="grid grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-bold mb-4">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</h3>
                        <div id="dragItems" class="grid grid-cols-2 gap-4">
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold mb-4">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h3>
                        <div class="space-y-4">
                            <div class="drop-zone h-24 rounded-lg flex items-center justify-center text-lg font-semibold" data-accept="input">
                                üì• ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </div>
                            <div class="drop-zone h-24 rounded-lg flex items-center justify-center text-lg font-semibold" data-accept="output">
                                üì§ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-4 text-center text-lg">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏ñ‡∏π‡∏Å: <span id="dragScore">0</span> ‡∏Ñ‡∏π‡πà</div>
            `;
            
            gameData.dragScore = 0;
            gameData.dragDevices = [
                { name: 'üñ±Ô∏è ‡πÄ‡∏°‡∏≤‡∏™‡πå', type: 'input', color: 'bg-blue-200' },
                { name: 'üñ•Ô∏è ‡∏à‡∏≠‡∏†‡∏≤‡∏û', type: 'output', color: 'bg-green-200' },
                { name: '‚å®Ô∏è ‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î', type: 'input', color: 'bg-yellow-200' },
                { name: 'üîä ‡∏•‡∏≥‡πÇ‡∏û‡∏á', type: 'output', color: 'bg-orange-200' },
                { name: 'üé§ ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô', type: 'input', color: 'bg-purple-200' },
                { name: 'üñ®Ô∏è ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå', type: 'output', color: 'bg-pink-200' },
                { name: 'üì∑ ‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏Ñ‡∏°', type: 'input', color: 'bg-indigo-200' },
                { name: 'üéß ‡∏´‡∏π‡∏ü‡∏±‡∏á', type: 'output', color: 'bg-red-200' }
            ];
            generateDragItems();
            setupDragAndDrop();
        }

        function generateDragItems() {
            const container = document.getElementById('dragItems');
            if (!container) return;
            
            // ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 4 ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
            const shuffled = [...gameData.dragDevices].sort(() => Math.random() - 0.5);
            const selectedDevices = shuffled.slice(0, 4);
            
            container.innerHTML = selectedDevices.map((device, index) => `
                <div class="draggable ${device.color} p-4 rounded-lg text-center cursor-grab" 
                     draggable="true" 
                     data-type="${device.type}" 
                     data-id="drag-${index}">
                    ${device.name}
                </div>
            `).join('');
        }

        function setupDragAndDrop() {
            const draggables = document.querySelectorAll('.draggable');
            const dropZones = document.querySelectorAll('.drop-zone');
            
            draggables.forEach(item => {
                item.addEventListener('dragstart', e => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.type);
                    e.dataTransfer.setData('element-id', e.target.id || e.target.textContent);
                    gameData.draggedElement = e.target;
                    sounds.click();
                });
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', e => {
                    e.preventDefault();
                    zone.classList.add('drag-over');
                });
                
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('drag-over');
                });
                
                zone.addEventListener('drop', e => {
                    e.preventDefault();
                    zone.classList.remove('drag-over');
                    
                    const draggedType = e.dataTransfer.getData('text/plain');
                    const acceptType = zone.dataset.accept;
                    
                    if (draggedType === acceptType && gameData.draggedElement) {
                        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡∏≤‡∏°‡∏î‡πà‡∏≤‡∏ô
                        if (currentLevel === 4) {
                            gameData.dragScore = (gameData.dragScore || 0) + 1;
                            document.getElementById('dragScore').textContent = gameData.dragScore;
                        } else if (currentLevel === 8) {
                            gameData.fileScore = (gameData.fileScore || 0) + 1;
                            document.getElementById('fileScore').textContent = gameData.fileScore;
                        } else if (currentLevel === 10) {
                            gameData.finalTasks.drag = true;
                            updateFinalProgress();
                        }
                        
                        currentScore += 25;
                        updateCombo();
                        addCoins(3, gameData.draggedElement);
                        createParticles(gameData.draggedElement);
                        sounds.success();
                        document.getElementById('currentScore').textContent = currentScore;
                        
                        // ‡∏ã‡πà‡∏≠‡∏ô element ‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å
                        gameData.draggedElement.style.opacity = '0.3';
                        gameData.draggedElement.draggable = false;
                        gameData.draggedElement = null;
                        
                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                        const remainingItems = document.querySelectorAll('.draggable[draggable="true"]');
                        if (remainingItems.length === 0) {
                            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà
                            setTimeout(() => {
                                if (currentLevel === 4) {
                                    generateDragItems();
                                    setupDragAndDrop();
                                } else if (currentLevel === 8) {
                                    generateFileItems();
                                    setupDragAndDrop();
                                }
                            }, 500);
                        }
                        
                        // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                        if ((gameData.dragScore >= 4 && currentLevel === 4) || 
                            (gameData.fileScore >= 4 && currentLevel === 8)) {
                            showAchievement('‡∏ô‡∏±‡∏Å‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö!', '‡∏à‡∏±‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏±‡∏ô');
                        }
                    } else {
                        sounds.error();
                    }
                });
            });
        }

        // ‡∏î‡πà‡∏≤‡∏ô 5: ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏™‡∏µ
        function setupColorMatchGame() {
            const colors = ['red', 'blue', 'green', 'yellow', 'purple', 'orange'];
            const gameArea = document.getElementById('gameArea');
            
            gameArea.innerHTML = `
                <div class="text-center mb-4">
                    <div class="text-xl mb-4">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏™‡∏µ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô</div>
                    <div id="targetColor" class="w-32 h-32 mx-auto rounded-lg mb-4 border-4 border-gray-300"></div>
                    <div class="grid grid-cols-3 gap-4 max-w-md mx-auto">
                        ${colors.map(color => `
                            <div class="w-20 h-20 rounded-lg cursor-pointer border-2 border-gray-300 hover:border-gray-500 transition-all" 
                                 style="background-color: ${color}" 
                                 onclick="selectColor('${color}')"></div>
                        `).join('')}
                    </div>
                    <div class="mt-4 text-lg">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏ñ‡∏π‡∏Å: <span id="colorScore">0</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                </div>
            `;
            
            gameData.colorScore = 0;
            gameData.targetColor = colors[Math.floor(Math.random() * colors.length)];
            document.getElementById('targetColor').style.backgroundColor = gameData.targetColor;
        }

        function selectColor(color) {
            if (color === gameData.targetColor) {
                gameData.colorScore = (gameData.colorScore || 0) + 1;
                currentScore += 20;
                updateCombo();
                addCoins(2, event.target);
                createParticles(event.target);
                sounds.success();
                
                document.getElementById('colorScore').textContent = gameData.colorScore;
                document.getElementById('currentScore').textContent = currentScore;
                
                // ‡∏™‡∏∏‡πà‡∏°‡∏™‡∏µ‡πÉ‡∏´‡∏°‡πà
                const colors = ['red', 'blue', 'green', 'yellow', 'purple', 'orange'];
                gameData.targetColor = colors[Math.floor(Math.random() * colors.length)];
                document.getElementById('targetColor').style.backgroundColor = gameData.targetColor;
                
                // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                if (gameData.colorScore === 15) {
                    showAchievement('‡∏ô‡∏±‡∏Å‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏™‡∏µ!', '‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏™‡∏µ‡πÑ‡∏î‡πâ 15 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß');
                }
            } else {
                sounds.error();
            }
        }

        // ‡∏î‡πà‡∏≤‡∏ô 6: ‡∏à‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö
        function setupSequenceGame() {
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = `
                <div class="text-center">
                    <div class="text-xl mb-4">‡∏à‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏ï‡∏≤‡∏°</div>
                    <div class="grid grid-cols-2 gap-4 max-w-md mx-auto mb-4">
                        <button class="pattern-button bg-red-500" data-color="red" onclick="playerInput('red')"></button>
                        <button class="pattern-button bg-blue-500" data-color="blue" onclick="playerInput('blue')"></button>
                        <button class="pattern-button bg-green-500" data-color="green" onclick="playerInput('green')"></button>
                        <button class="pattern-button bg-yellow-500" data-color="yellow" onclick="playerInput('yellow')"></button>
                    </div>
                    <button id="startSequence" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold" onclick="startSequence()">
                        ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÉ‡∏´‡∏°‡πà
                    </button>
                    <div class="mt-4 text-lg">‡∏£‡∏∞‡∏î‡∏±‡∏ö: <span id="sequenceLevel">1</span></div>
                </div>
            `;
            
            gameData.sequence = [];
            gameData.playerSequence = [];
            gameData.sequenceLevel = 1;
            gameData.isPlaying = false;
        }

        function startSequence() {
            const colors = ['red', 'blue', 'green', 'yellow'];
            gameData.sequence.push(colors[Math.floor(Math.random() * colors.length)]);
            gameData.playerSequence = [];
            gameData.isPlaying = true;
            
            document.getElementById('startSequence').disabled = true;
            sounds.click();
            playSequence();
        }

        function playSequence() {
            gameData.sequence.forEach((color, index) => {
                setTimeout(() => {
                    const button = document.querySelector(`[data-color="${color}"]`);
                    button.classList.add('active');
                    sounds.click();
                    setTimeout(() => {
                        button.classList.remove('active');
                        if (index === gameData.sequence.length - 1) {
                            document.getElementById('startSequence').disabled = false;
                        }
                    }, 300);
                }, (index + 1) * 600);
            });
        }

        function playerInput(color) {
            if (!gameData.isPlaying) return;
            
            gameData.playerSequence.push(color);
            sounds.click();
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
            const currentIndex = gameData.playerSequence.length - 1;
            if (gameData.playerSequence[currentIndex] !== gameData.sequence[currentIndex]) {
                // ‡∏ú‡∏¥‡∏î - ‡πÅ‡∏™‡∏î‡∏á reaction ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                const button = event.target;
                button.style.backgroundColor = '#ff4444';
                button.style.transform = 'scale(0.8)';
                sounds.error();
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î
                const errorMsg = document.createElement('div');
                errorMsg.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white px-6 py-4 rounded-lg text-xl font-bold z-50';
                errorMsg.textContent = '‚ùå ‡∏ú‡∏¥‡∏î! ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà';
                document.body.appendChild(errorMsg);
                
                setTimeout(() => {
                    button.style.backgroundColor = '';
                    button.style.transform = '';
                    errorMsg.remove();
                }, 1000);
                
                gameData.sequence = [];
                gameData.sequenceLevel = 1;
                gameData.isPlaying = false;
                document.getElementById('sequenceLevel').textContent = gameData.sequenceLevel;
                return;
            } else {
                // ‡∏ñ‡∏π‡∏Å - ‡πÅ‡∏™‡∏î‡∏á reaction ‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å
                const button = event.target;
                button.style.backgroundColor = '#44ff44';
                button.style.transform = 'scale(1.1)';
                
                setTimeout(() => {
                    button.style.backgroundColor = '';
                    button.style.transform = '';
                }, 200);
            }
            
            // ‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡∏Ñ‡∏£‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö
            if (gameData.playerSequence.length === gameData.sequence.length) {
                gameData.sequenceLevel++;
                currentScore += gameData.sequenceLevel * 10;
                updateCombo();
                addCoins(gameData.sequenceLevel, event.target);
                sounds.success();
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                const successMsg = document.createElement('div');
                successMsg.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-6 py-4 rounded-lg text-xl font-bold z-50';
                successMsg.textContent = `‚úÖ ‡πÄ‡∏Å‡πà‡∏á! ‡∏£‡∏∞‡∏î‡∏±‡∏ö ${gameData.sequenceLevel}`;
                document.body.appendChild(successMsg);
                
                setTimeout(() => successMsg.remove(), 1500);
                
                document.getElementById('sequenceLevel').textContent = gameData.sequenceLevel;
                document.getElementById('currentScore').textContent = currentScore;
                gameData.isPlaying = false;
                
                // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                if (gameData.sequenceLevel === 8) {
                    showAchievement('‡∏ô‡∏±‡∏Å‡∏à‡∏≥!', '‡∏à‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏î‡∏±‡∏ö 8');
                }
            }
        }

        // ‡∏î‡πà‡∏≤‡∏ô 7: ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î
        function setupShortcutGame() {
            const shortcuts = [
                { key: 'Ctrl+C', action: '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å', code: 'KeyC' },
                { key: 'Ctrl+V', action: '‡∏ß‡∏≤‡∏á', code: 'KeyV' },
                { key: 'Ctrl+Z', action: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å', code: 'KeyZ' },
                { key: 'Ctrl+S', action: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å', code: 'KeyS' }
            ];
            
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = `
                <div class="text-center">
                    <div class="text-xl mb-4">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á</div>
                    <div id="shortcutCommand" class="text-3xl font-bold text-purple-600 mb-4"></div>
                    <div class="text-lg mb-4">‡∏Å‡∏î: <span id="shortcutKey" class="font-mono bg-gray-200 px-2 py-1 rounded"></span></div>
                    <div class="text-lg">‡∏ó‡∏≥‡∏ñ‡∏π‡∏Å: <span id="shortcutScore">0</span> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                </div>
            `;
            
            gameData.shortcuts = shortcuts;
            gameData.currentShortcut = shortcuts[0];
            gameData.shortcutScore = 0;
            gameData.ctrlPressed = false;
            
            updateShortcutDisplay();
            setupShortcutListeners();
        }

        function updateShortcutDisplay() {
            document.getElementById('shortcutCommand').textContent = gameData.currentShortcut.action;
            document.getElementById('shortcutKey').textContent = gameData.currentShortcut.key;
        }

        function setupShortcutListeners() {
            document.addEventListener('keydown', handleShortcut);
            document.addEventListener('keyup', handleShortcutKeyUp);
        }

        function handleShortcutKeyUp(e) {
            if (e.key === 'Control') gameData.ctrlPressed = false;
        }

        function handleShortcut(e) {
            if (currentLevel !== 7) return;
            
            if (e.key === 'Control') {
                gameData.ctrlPressed = true;
                return;
            }
            
            if (gameData.ctrlPressed && e.code === gameData.currentShortcut.code) {
                e.preventDefault();
                gameData.shortcutScore = (gameData.shortcutScore || 0) + 1;
                currentScore += 15;
                updateCombo();
                addCoins(2, document.getElementById('shortcutKey'));
                sounds.success();
                
                document.getElementById('shortcutScore').textContent = gameData.shortcutScore;
                document.getElementById('currentScore').textContent = currentScore;
                
                // ‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡∏°‡πà
                gameData.currentShortcut = gameData.shortcuts[Math.floor(Math.random() * gameData.shortcuts.length)];
                updateShortcutDisplay();
                
                // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                if (gameData.shortcutScore === 10) {
                    showAchievement('‡∏ô‡∏±‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î!', '‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏±‡∏î‡πÑ‡∏î‡πâ 10 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß');
                }
            }
        }

        // ‡∏î‡πà‡∏≤‡∏ô 8: ‡∏à‡∏±‡∏î‡πÑ‡∏ü‡∏•‡πå
        function setupFileOrganizerGame() {
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = `
                <div class="grid grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-bold mb-4">‡πÑ‡∏ü‡∏•‡πå</h3>
                        <div id="fileItems" class="space-y-2">
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold mb-4">‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå</h3>
                        <div class="space-y-4">
                            <div class="drop-zone h-20 bg-blue-50 rounded-lg flex items-center justify-center" data-accept="document">
                                üìÅ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
                            </div>
                            <div class="drop-zone h-20 bg-green-50 rounded-lg flex items-center justify-center" data-accept="image">
                                üìÅ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                            </div>
                            <div class="drop-zone h-20 bg-red-50 rounded-lg flex items-center justify-center" data-accept="video">
                                üìÅ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-4 text-center text-lg">‡∏à‡∏±‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å: <span id="fileScore">0</span> ‡πÑ‡∏ü‡∏•‡πå</div>
            `;
            
            gameData.fileScore = 0;
            gameData.fileTypes = {
                document: { 
                    extensions: ['.docx', '.pdf', '.txt', '.pptx', '.xlsx'], 
                    names: ['‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô', '‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£', '‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°', '‡∏á‡∏≤‡∏ô‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠', '‡∏ï‡∏≤‡∏£‡∏≤‡∏á'],
                    icon: 'üìÑ',
                    color: 'bg-blue-100'
                },
                image: { 
                    extensions: ['.jpg', '.png', '.gif', '.bmp', '.svg'], 
                    names: ['‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û', '‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢', '‡πÇ‡∏•‡πÇ‡∏Å‡πâ', '‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô', '‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå'],
                    icon: 'üñºÔ∏è',
                    color: 'bg-green-100'
                },
                video: { 
                    extensions: ['.mp4', '.avi', '.mov', '.wmv', '.mkv'], 
                    names: ['‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠', '‡∏´‡∏ô‡∏±‡∏á', '‡∏Ñ‡∏•‡∏¥‡∏õ', '‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å', '‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô'],
                    icon: 'üé•',
                    color: 'bg-red-100'
                }
            };
            generateFileItems();
            setupDragAndDrop();
        }

        function generateFileItems() {
            const container = document.getElementById('fileItems');
            if (!container) return;
            
            const types = Object.keys(gameData.fileTypes);
            const files = [];
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå 4 ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°
            for (let i = 0; i < 4; i++) {
                const type = types[Math.floor(Math.random() * types.length)];
                const typeData = gameData.fileTypes[type];
                const name = typeData.names[Math.floor(Math.random() * typeData.names.length)];
                const ext = typeData.extensions[Math.floor(Math.random() * typeData.extensions.length)];
                
                files.push({
                    name: `${typeData.icon} ${name}${ext}`,
                    type: type,
                    color: typeData.color
                });
            }
            
            container.innerHTML = files.map((file, index) => `
                <div class="draggable ${file.color} p-3 rounded cursor-grab" 
                     draggable="true" 
                     data-type="${file.type}" 
                     data-id="file-${index}">
                    ${file.name}
                </div>
            `).join('');
        }

        // ‡∏î‡πà‡∏≤‡∏ô 9: ‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï
        function setupMazeGame() {
            gameData.mazeLevel = 1;
            gameData.mazeScore = 0;
            generateNewMaze();
        }

        function generateNewMaze() {
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°
            const mazeTemplates = [
                // ‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï 1
                [
                    [1,1,1,1,1,1,1,1,1,1],
                    [1,0,0,0,1,0,0,0,0,1],
                    [1,0,1,0,1,0,1,1,0,1],
                    [1,0,1,0,0,0,0,1,0,1],
                    [1,0,1,1,1,1,0,1,0,1],
                    [1,0,0,0,0,0,0,1,0,1],
                    [1,1,1,0,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,1,2,1],
                    [1,1,1,1,1,1,1,1,1,1]
                ],
                // ‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï 2
                [
                    [1,1,1,1,1,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,1],
                    [1,0,1,1,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,1,0,1],
                    [1,1,1,1,0,1,0,1,0,1],
                    [1,0,0,0,0,1,0,0,0,1],
                    [1,0,1,1,1,1,1,1,1,1],
                    [1,0,0,0,0,0,0,0,0,1],
                    [1,1,1,1,1,1,1,1,2,1],
                    [1,1,1,1,1,1,1,1,1,1]
                ],
                // ‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï 3
                [
                    [1,1,1,1,1,1,1,1,1,1],
                    [1,0,1,0,0,0,1,0,0,1],
                    [1,0,1,0,1,0,1,0,1,1],
                    [1,0,0,0,1,0,0,0,0,1],
                    [1,1,1,0,1,1,1,1,0,1],
                    [1,0,0,0,0,0,0,1,0,1],
                    [1,0,1,1,1,1,0,1,0,1],
                    [1,0,0,0,0,0,0,0,0,1],
                    [1,1,1,1,1,1,1,1,2,1],
                    [1,1,1,1,1,1,1,1,1,1]
                ]
            ];
            
            const maze = mazeTemplates[Math.floor(Math.random() * mazeTemplates.length)];
            
            const gameArea = document.getElementById('gameArea');
            let mazeHTML = `
                <div class="text-center mb-4">
                    <div class="text-lg">‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï‡∏ó‡∏µ‡πà ${gameData.mazeLevel} | ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß: ${gameData.mazeScore} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                </div>
                <div class="inline-block border-2 border-gray-800">
            `;
            
            maze.forEach((row, y) => {
                mazeHTML += '<div class="flex">';
                row.forEach((cell, x) => {
                    let cellClass = 'maze-cell ';
                    if (cell === 1) cellClass += 'maze-wall';
                    else if (cell === 0) cellClass += 'maze-path';
                    else if (cell === 2) cellClass += 'maze-goal';
                    
                    mazeHTML += `<div class="${cellClass}" data-x="${x}" data-y="${y}"></div>`;
                });
                mazeHTML += '</div>';
            });
            
            mazeHTML += '</div>';
            mazeHTML += '<div class="mt-4 text-center"><div class="text-lg">‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏®‡∏£ WASD ‡∏´‡∏£‡∏∑‡∏≠ ‚Üê‚Üë‚Üì‚Üí ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà</div></div>';
            
            gameArea.innerHTML = mazeHTML;
            
            gameData.maze = maze;
            gameData.playerPos = { x: 1, y: 1 };
            
            // ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
            for (let y = 0; y < maze.length; y++) {
                for (let x = 0; x < maze[y].length; x++) {
                    if (maze[y][x] === 2) {
                        gameData.goalPos = { x, y };
                        break;
                    }
                }
            }
            
            updateMazeDisplay();
            setupMazeControls();
        }

        function updateMazeDisplay() {
            // ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏Å‡πà‡∏≤
            document.querySelectorAll('.maze-player').forEach(cell => {
                cell.classList.remove('maze-player');
                cell.classList.add('maze-path');
            });
            
            // ‡∏ß‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà
            const playerCell = document.querySelector(`[data-x="${gameData.playerPos.x}"][data-y="${gameData.playerPos.y}"]`);
            if (playerCell) {
                playerCell.classList.remove('maze-path');
                playerCell.classList.add('maze-player');
            }
        }

        function setupMazeControls() {
            document.addEventListener('keydown', handleMazeMovement);
        }

        function handleMazeMovement(e) {
            if (currentLevel !== 9) return;
            
            let newX = gameData.playerPos.x;
            let newY = gameData.playerPos.y;
            
            switch(e.key) {
                case 'ArrowUp':
                case 'w':
                case 'W':
                    newY--;
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                    newY++;
                    break;
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    newX--;
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    newX++;
                    break;
                default:
                    return;
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (gameData.maze[newY] && gameData.maze[newY][newX] !== 1) {
                gameData.playerPos.x = newX;
                gameData.playerPos.y = newY;
                updateMazeDisplay();
                sounds.click();
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if (newX === gameData.goalPos.x && newY === gameData.goalPos.y) {
                    gameData.mazeScore++;
                    gameData.mazeLevel++;
                    currentScore += 50 + (gameData.mazeLevel * 10);
                    updateCombo();
                    addCoins(5 + gameData.mazeLevel, document.querySelector('.maze-goal'));
                    sounds.levelComplete();
                    
                    document.getElementById('currentScore').textContent = currentScore;
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                    const successMsg = document.createElement('div');
                    successMsg.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-6 py-4 rounded-lg text-xl font-bold z-50';
                    successMsg.textContent = `üéâ ‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï‡πÅ‡∏•‡πâ‡∏ß! ‡∏î‡πà‡∏≤‡∏ô ${gameData.mazeLevel}`;
                    document.body.appendChild(successMsg);
                    
                    setTimeout(() => {
                        successMsg.remove();
                        generateNewMaze(); // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï‡πÉ‡∏´‡∏°‡πà
                    }, 1500);
                    
                    // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                    if (gameData.mazeScore === 3) {
                        showAchievement('‡∏ô‡∏±‡∏Å‡∏™‡∏≥‡∏£‡∏ß‡∏à!', '‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡∏≤‡∏ß‡∏á‡∏Å‡∏ï 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß');
                    }
                }
            } else {
                sounds.error();
            }
        }

        // ‡∏î‡πà‡∏≤‡∏ô 10: ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô
        function setupFinalGame() {
            const gameArea = document.getElementById('gameArea');
            gameArea.innerHTML = `
                <div class="text-center">
                    <div class="text-xl mb-4">‡∏î‡πà‡∏≤‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢: ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î!</div>
                    <div class="grid grid-cols-2 gap-8">
                        <div>
                            <div class="bg-blue-100 p-4 rounded-lg mb-4">
                                <h4 class="font-bold mb-2">‡∏á‡∏≤‡∏ô 1: ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏õ‡πâ‡∏≤</h4>
                                <div id="finalTarget" class="w-16 h-16 bg-red-500 rounded-full mx-auto cursor-pointer" onclick="finalTargetHit()">üéØ</div>
                            </div>
                            <div class="bg-green-100 p-4 rounded-lg">
                                <h4 class="font-bold mb-2">‡∏á‡∏≤‡∏ô 2: ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥</h4>
                                <div id="finalWord" class="text-xl font-bold mb-2">HELLO</div>
                                <input type="text" id="finalTyping" class="w-full p-2 border rounded" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà">
                            </div>
                        </div>
                        <div>
                            <div class="bg-yellow-100 p-4 rounded-lg mb-4">
                                <h4 class="font-bold mb-2">‡∏á‡∏≤‡∏ô 3: ‡∏•‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á</h4>
                                <div class="draggable bg-purple-200 p-2 rounded mb-2 cursor-grab" draggable="true" data-type="final">üì¶ ‡∏Å‡∏•‡πà‡∏≠‡∏á</div>
                                <div class="drop-zone h-16 border-2 border-dashed border-gray-400 rounded flex items-center justify-center" data-accept="final">‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</div>
                            </div>
                            <div class="bg-red-100 p-4 rounded-lg">
                                <h4 class="font-bold mb-2">‡∏á‡∏≤‡∏ô 4: ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏™‡∏µ</h4>
                                <div class="grid grid-cols-2 gap-2">
                                    <div class="w-12 h-12 bg-blue-500 rounded cursor-pointer" onclick="finalColorMatch('blue')"></div>
                                    <div class="w-12 h-12 bg-red-500 rounded cursor-pointer" onclick="finalColorMatch('red')"></div>
                                </div>
                                <div id="finalColorTarget" class="w-8 h-8 bg-blue-500 rounded mx-auto mt-2"></div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 text-lg">‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à: <span id="finalTasksComplete">0</span>/4</div>
                </div>
            `;
            
            gameData.finalTasks = {
                target: false,
                typing: false,
                drag: false,
                color: false
            };
            gameData.finalTargetColor = 'blue';
            
            setupDragAndDrop();
            setupFinalTyping();
        }

        function setupFinalTyping() {
            const input = document.getElementById('finalTyping');
            input.addEventListener('input', () => {
                if (input.value.toLowerCase() === 'hello') {
                    gameData.finalTasks.typing = true;
                    updateFinalProgress();
                    input.disabled = true;
                    input.style.backgroundColor = '#d4edda';
                    sounds.success();
                }
            });
        }

        function finalTargetHit() {
            gameData.finalTasks.target = true;
            updateFinalProgress();
            document.getElementById('finalTarget').onclick = null;
            document.getElementById('finalTarget').style.backgroundColor = '#28a745';
            sounds.success();
        }

        function finalColorMatch(color) {
            if (color === gameData.finalTargetColor) {
                gameData.finalTasks.color = true;
                currentScore += 50;
                addCoins(5, event.target);
                document.getElementById('currentScore').textContent = currentScore;
                updateFinalProgress();
                sounds.success();
                
                // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å
                document.querySelectorAll('[onclick*="finalColorMatch"]').forEach(btn => {
                    btn.onclick = null;
                    btn.style.opacity = '0.5';
                });
            } else {
                sounds.error();
            }
        }

        function updateFinalProgress() {
            const completed = Object.values(gameData.finalTasks).filter(task => task).length;
            document.getElementById('finalTasksComplete').textContent = completed;
            
            if (completed === 4) {
                currentScore += 200;
                addCoins(20, document.getElementById('finalTasksComplete'));
                document.getElementById('currentScore').textContent = currentScore;
                showAchievement('‡∏õ‡∏£‡∏°‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå!', '‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!');
                sounds.levelComplete();
                
                setTimeout(() => {
                    alert('üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß! üéâ');
                    // ‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô 10
                    endGame();
                }, 1000);
            }
        }

        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤
        function startTimer() {
            const totalTime = 60;
            const circumference = 2 * Math.PI * 28; // r = 28
            
            gameTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('timeLeft').textContent = timeLeft;
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤
                const progress = (totalTime - timeLeft) / totalTime;
                const offset = circumference * progress;
                document.getElementById('progressCircle').style.strokeDashoffset = offset;
                
                // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î
                const circle = document.getElementById('progressCircle');
                if (timeLeft <= 10) {
                    circle.style.stroke = '#ef4444'; // ‡∏™‡∏µ‡πÅ‡∏î‡∏á
                    if (timeLeft <= 5) {
                        sounds.click(); // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                    }
                } else if (timeLeft <= 20) {
                    circle.style.stroke = '#f59e0b'; // ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
                } else {
                    circle.style.stroke = '#3b82f6'; // ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
                }
                
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        // ‡∏à‡∏ö‡πÄ‡∏Å‡∏°
        function endGame() {
            clearInterval(gameTimer);
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
            const currentHighScore = parseInt(localStorage.getItem(`level${currentLevel}Score`) || 0);
            let message = `‡πÄ‡∏Å‡∏°‡∏à‡∏ö!\n‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${currentScore}\n‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ: ${currentCoins}`;
            
            if (currentScore > currentHighScore) {
                localStorage.setItem(`level${currentLevel}Score`, currentScore);
                message = `üéâ ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÉ‡∏´‡∏°‡πà!\n‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${currentScore}\n‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ: ${currentCoins}`;
                sounds.levelComplete();
                
                // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÉ‡∏´‡∏°‡πà
                showAchievement('‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÉ‡∏´‡∏°‡πà!', `‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏î‡πà‡∏≤‡∏ô ${currentLevel}`);
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏û‡∏¥‡πÄ‡∏®‡∏©
            if (currentScore >= 300) {
                showAchievement('‡∏õ‡∏£‡∏°‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå!', '‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô 300');
            } else if (currentScore >= 200) {
                showAchievement('‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç!', '‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô 200');
            } else if (currentScore >= 100) {
                showAchievement('‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡∏µ!', '‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô 100');
            }
            
            setTimeout(() => {
                alert(message);
                backToMenu();
            }, 1000);
        }

        // ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        function backToMenu() {
            clearInterval(gameTimer);
            gameTimer = null;
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
            
            // ‡∏•‡πâ‡∏≤‡∏á event listeners
            document.removeEventListener('keydown', handleShortcut);
            document.removeEventListener('keydown', handleMazeMovement);
            document.removeEventListener('keyup', handleShortcutKeyUp);
            
            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡∏°
            gameData = {};
            currentScore = 0;
            currentCoins = 0;
            combo = 0;
            
            sounds.click();
            loadScores();
        }

        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
        function resetAllScores() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n‚ö†Ô∏è ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Leaderboard')) {
                for (let i = 1; i <= 10; i++) {
                    localStorage.removeItem(`level${i}Score`);
                }
                localStorage.removeItem('totalCoins');
                sounds.click();
                loadScores();
                showAchievement('‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà!', '‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        function resetLeaderboard() {
            const password = prompt('üîí ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏≤‡∏á Leaderboard:\n\n(‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)');
            
            if (password === null) {
                // ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î Cancel
                return;
            }
            
            if (password !== 'cttc19') {
                sounds.error();
                alert('‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö');
                return;
            }
            
            if (confirm('‚úÖ ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!\n\n‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Leaderboard ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ!')) {
                // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• leaderboard
                localStorage.removeItem('leaderboardEntries');
                for (let i = 1; i <= 10; i++) {
                    localStorage.removeItem(`level${i}Scores`);
                }
                
                sounds.success();
                updateLeaderboards();
                showAchievement('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß!', '‡∏•‡∏ö Leaderboard ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
        window.addEventListener('error', function(e) {
            console.log('Error caught:', e.error);
        });

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        window.onload = function() {
            loadScores();
            
            // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡∏ì‡∏∞‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°
            window.addEventListener('beforeunload', function(e) {
                if (gameTimer) {
                    e.preventDefault();
                    e.returnValue = '‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏≠‡∏¢‡∏π‡πà ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠?';
                }
            });
        };
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97bcc20e37497331',t:'MTc1NzMxNjgxMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
